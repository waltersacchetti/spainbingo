<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BingoRoyal - Test de Detecci√≥n de Dispositivos</title>
    <link rel="stylesheet" href="styles-codere.css">
    <link rel="stylesheet" href="mobile-optimizations.css">
    <link rel="stylesheet" href="adaptive-styles.css">
    <style>
        .device-test-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            font-family: 'Poppins', sans-serif;
        }
        
        .test-section {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid var(--border-color);
        }
        
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .info-card {
            background: var(--bg-primary);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid var(--border-color);
        }
        
        .info-card h4 {
            color: var(--secondary-color);
            margin: 0 0 10px 0;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .info-label {
            font-weight: 600;
            color: var(--text-primary);
        }
        
        .info-value {
            color: var(--text-muted);
            text-align: right;
            max-width: 200px;
            word-break: break-word;
        }
        
        .device-indicator {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 600;
            margin: 5px;
        }
        
        .device-mobile { background: #4CAF50; color: white; }
        .device-tablet { background: #FF9800; color: white; }
        .device-desktop { background: #2196F3; color: white; }
        
        .capability-yes { color: #4CAF50; font-weight: 600; }
        .capability-no { color: #f44336; font-weight: 600; }
        
        .test-button {
            background: var(--primary-color);
            color: var(--secondary-color);
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-weight: 600;
        }
        
        .test-result {
            background: var(--bg-tertiary);
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid var(--secondary-color);
        }
        
        .experience-demo {
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
            
            .info-item {
                flex-direction: column;
            }
            
            .info-value {
                text-align: left;
                max-width: none;
                margin-top: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="device-test-container">
        <header style="text-align: center; margin-bottom: 30px;">
            <h1>üîç Test de Detecci√≥n de Dispositivos - BingoRoyal</h1>
            <p>Sistema completo de detecci√≥n y adaptaci√≥n por dispositivo</p>
        </header>

        <!-- Informaci√≥n del dispositivo detectado -->
        <section class="test-section">
            <h2>üì± Dispositivo Detectado</h2>
            <div id="deviceType" class="text-center">
                <span class="device-indicator" id="deviceBadge">Detectando...</span>
            </div>
            <div class="test-grid">
                <div class="info-card">
                    <h4>üîç Detecci√≥n JavaScript</h4>
                    <div class="info-item">
                        <span class="info-label">Tipo:</span>
                        <span class="info-value" id="jsDeviceType">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Sistema Operativo:</span>
                        <span class="info-value" id="jsDeviceOS">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Categor√≠a:</span>
                        <span class="info-value" id="jsDeviceCategory">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Orientaci√≥n:</span>
                        <span class="info-value" id="jsOrientation">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h4>üåê Informaci√≥n del Servidor</h4>
                    <div class="info-item">
                        <span class="info-label">Hint del Servidor:</span>
                        <span class="info-value" id="serverHint">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">User Agent:</span>
                        <span class="info-value" id="userAgent">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">IP Cliente:</span>
                        <span class="info-value" id="clientIP">-</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Capacidades del dispositivo -->
        <section class="test-section">
            <h2>‚ö° Capacidades del Dispositivo</h2>
            <div class="test-grid">
                <div class="info-card">
                    <h4>üëÜ Interacci√≥n</h4>
                    <div class="info-item">
                        <span class="info-label">Soporte T√°ctil:</span>
                        <span class="info-value" id="touchSupport">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Vibraci√≥n:</span>
                        <span class="info-value" id="vibrationSupport">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Orientaci√≥n:</span>
                        <span class="info-value" id="orientationSupport">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h4>üì± Hardware</h4>
                    <div class="info-item">
                        <span class="info-label">N√∫cleos CPU:</span>
                        <span class="info-value" id="cpuCores">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Memoria:</span>
                        <span class="info-value" id="deviceMemory">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Pantalla Retina:</span>
                        <span class="info-value" id="retinaDisplay">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h4>üåê Conectividad</h4>
                    <div class="info-item">
                        <span class="info-label">Tipo Conexi√≥n:</span>
                        <span class="info-value" id="connectionType">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Velocidad:</span>
                        <span class="info-value" id="connectionSpeed">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Ahorro Datos:</span>
                        <span class="info-value" id="saveData">-</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Informaci√≥n de pantalla -->
        <section class="test-section">
            <h2>üì∫ Informaci√≥n de Pantalla</h2>
            <div class="test-grid">
                <div class="info-card">
                    <h4>üìè Dimensiones</h4>
                    <div class="info-item">
                        <span class="info-label">Ancho Ventana:</span>
                        <span class="info-value" id="windowWidth">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Alto Ventana:</span>
                        <span class="info-value" id="windowHeight">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Ancho Pantalla:</span>
                        <span class="info-value" id="screenWidth">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Alto Pantalla:</span>
                        <span class="info-value" id="screenHeight">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h4>üé® Display</h4>
                    <div class="info-item">
                        <span class="info-label">DPI Ratio:</span>
                        <span class="info-value" id="pixelRatio">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Profundidad Color:</span>
                        <span class="info-value" id="colorDepth">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Orientaci√≥n Actual:</span>
                        <span class="info-value" id="currentOrientation">-</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Pruebas de funcionalidad -->
        <section class="test-section">
            <h2>üß™ Pruebas de Funcionalidad</h2>
            <div style="text-align: center; margin: 20px 0;">
                <button class="test-button" onclick="testVibration()">üì≥ Probar Vibraci√≥n</button>
                <button class="test-button" onclick="testOrientation()">üîÑ Probar Orientaci√≥n</button>
                <button class="test-button" onclick="testTouch()">üëÜ Probar Touch</button>
                <button class="test-button" onclick="testServerDetection()">üåê Probar Servidor</button>
                <button class="test-button" onclick="refreshDetection()">üîÑ Refrescar</button>
            </div>
            <div id="testResults"></div>
        </section>

        <!-- Demostraci√≥n de experiencia -->
        <section class="test-section">
            <h2>üéØ Experiencia Adaptativa</h2>
            <div class="experience-demo" id="experienceDemo">
                <p>Esta secci√≥n se adapta seg√∫n tu dispositivo...</p>
            </div>
        </section>

        <!-- Recomendaciones -->
        <section class="test-section">
            <h2>üí° Recomendaciones</h2>
            <div id="recommendations">
                <p>Cargando recomendaciones...</p>
            </div>
        </section>

    </div>

    <!-- Scripts -->
    <script src="device-detection.js"></script>
    <script>
        let testResults = [];
        
        function updateDeviceInfo() {
            if (!window.deviceDetector) {
                setTimeout(updateDeviceInfo, 100);
                return;
            }
            
            const device = deviceDetector.getDevice();
            const capabilities = deviceDetector.getCapabilities();
            
            // Informaci√≥n b√°sica del dispositivo
            document.getElementById('jsDeviceType').textContent = device.type;
            document.getElementById('jsDeviceOS').textContent = device.os;
            document.getElementById('jsDeviceCategory').textContent = device.category;
            document.getElementById('jsOrientation').textContent = device.orientation;
            
            // Badge del dispositivo
            const badge = document.getElementById('deviceBadge');
            badge.textContent = `${device.type.toUpperCase()} - ${device.os.toUpperCase()}`;
            badge.className = `device-indicator device-${device.type}`;
            
            // Capacidades
            document.getElementById('touchSupport').innerHTML = capabilities.touch ? 
                '<span class="capability-yes">‚úÖ S√≠</span>' : '<span class="capability-no">‚ùå No</span>';
            document.getElementById('vibrationSupport').innerHTML = capabilities.vibration ? 
                '<span class="capability-yes">‚úÖ S√≠</span>' : '<span class="capability-no">‚ùå No</span>';
            document.getElementById('orientationSupport').innerHTML = capabilities.orientation ? 
                '<span class="capability-yes">‚úÖ S√≠</span>' : '<span class="capability-no">‚ùå No</span>';
            
            // Hardware
            document.getElementById('cpuCores').textContent = capabilities.cores;
            document.getElementById('deviceMemory').textContent = capabilities.memory + ' GB';
            document.getElementById('retinaDisplay').innerHTML = capabilities.retina ? 
                '<span class="capability-yes">‚úÖ S√≠</span>' : '<span class="capability-no">‚ùå No</span>';
            
            // Conectividad
            if (capabilities.connection) {
                document.getElementById('connectionType').textContent = capabilities.connection.type || 'Unknown';
                document.getElementById('connectionSpeed').textContent = capabilities.connection.downlink ? 
                    capabilities.connection.downlink + ' Mbps' : 'Unknown';
                document.getElementById('saveData').innerHTML = capabilities.connection.saveData ? 
                    '<span class="capability-yes">‚úÖ Activo</span>' : '<span class="capability-no">‚ùå Inactivo</span>';
            } else {
                document.getElementById('connectionType').textContent = 'No disponible';
                document.getElementById('connectionSpeed').textContent = 'No disponible';
                document.getElementById('saveData').textContent = 'No disponible';
            }
            
            // Informaci√≥n de pantalla
            document.getElementById('windowWidth').textContent = window.innerWidth + 'px';
            document.getElementById('windowHeight').textContent = window.innerHeight + 'px';
            document.getElementById('screenWidth').textContent = screen.width + 'px';
            document.getElementById('screenHeight').textContent = screen.height + 'px';
            document.getElementById('pixelRatio').textContent = window.devicePixelRatio;
            document.getElementById('colorDepth').textContent = screen.colorDepth + ' bits';
            document.getElementById('currentOrientation').textContent = device.orientation;
            
            // User Agent
            document.getElementById('userAgent').textContent = navigator.userAgent.substring(0, 50) + '...';
            
            // Informaci√≥n del servidor
            if (window.SERVER_DEVICE_HINT) {
                const hint = window.SERVER_DEVICE_HINT;
                document.getElementById('serverHint').textContent = hint.isMobile ? 'Mobile' : 
                    hint.isTablet ? 'Tablet' : 'Desktop';
            }
            
            updateExperienceDemo(device);
            updateRecommendations(device, capabilities);
        }
        
        function updateExperienceDemo(device) {
            const demo = document.getElementById('experienceDemo');
            
            if (device.type === 'mobile') {
                demo.innerHTML = `
                    <h3>üì± Experiencia M√≥vil</h3>
                    <p>‚úÖ Men√∫ hamburguesa activado</p>
                    <p>‚úÖ Navegaci√≥n t√°ctil optimizada</p>
                    <p>‚úÖ Cartones adaptados para touch</p>
                    <p>‚úÖ Chat fullscreen</p>
                `;
                demo.style.background = '#E8F5E8';
                demo.style.borderColor = '#4CAF50';
            } else if (device.type === 'tablet') {
                demo.innerHTML = `
                    <h3>üì± Experiencia Tablet</h3>
                    <p>‚úÖ Layout h√≠brido m√≥vil/desktop</p>
                    <p>‚úÖ Navegaci√≥n adaptativa</p>
                    <p>‚úÖ Aprovecha orientaci√≥n landscape</p>
                    <p>‚úÖ Chat lateral</p>
                `;
                demo.style.background = '#FFF3E0';
                demo.style.borderColor = '#FF9800';
            } else {
                demo.innerHTML = `
                    <h3>üñ•Ô∏è Experiencia Desktop</h3>
                    <p>‚úÖ Layout completo con sidebars</p>
                    <p>‚úÖ Efectos hover habilitados</p>
                    <p>‚úÖ Atajos de teclado activos</p>
                    <p>‚úÖ Chat flotante</p>
                `;
                demo.style.background = '#E3F2FD';
                demo.style.borderColor = '#2196F3';
            }
        }
        
        function updateRecommendations(device, capabilities) {
            const recommendations = document.getElementById('recommendations');
            let html = '<h4>üí° Recomendaciones para tu dispositivo:</h4><ul>';
            
            if (device.type === 'mobile') {
                html += '<li>üéØ Usa gestos swipe para navegar entre pesta√±as</li>';
                html += '<li>üì± El men√∫ hamburguesa est√° disponible en la esquina superior derecha</li>';
                html += '<li>üëÜ Los n√∫meros de cartones est√°n optimizados para touch</li>';
                if (capabilities.vibration) {
                    html += '<li>üì≥ Feedback h√°ptico activado al marcar n√∫meros</li>';
                }
            } else if (device.type === 'tablet') {
                html += '<li>üîÑ Gira tu dispositivo para aprovechar el modo landscape</li>';
                html += '<li>üì± Usa navegaci√≥n por pesta√±as en la parte superior</li>';
                html += '<li>üëÜ Interfaz h√≠brida optimizada para tablet</li>';
            } else {
                html += '<li>‚å®Ô∏è Usa Ctrl+H para ver atajos de teclado</li>';
                html += '<li>üñ±Ô∏è Efectos hover disponibles en todos los elementos</li>';
                html += '<li>üí¨ Chat lateral flotante disponible</li>';
                html += '<li>üñ•Ô∏è Layout completo con informaci√≥n en sidebars</li>';
            }
            
            if (capabilities.cores <= 2) {
                html += '<li>‚ö° Modo performance activado para tu dispositivo</li>';
            }
            
            if (capabilities.connection && capabilities.connection.saveData) {
                html += '<li>üìä Modo ahorro de datos detectado - interfaz simplificada</li>';
            }
            
            html += '</ul>';
            recommendations.innerHTML = html;
        }
        
        // Funciones de prueba
        function testVibration() {
            if (navigator.vibrate) {
                navigator.vibrate([200, 100, 200]);
                addTestResult('‚úÖ Vibraci√≥n funcionando correctamente', 'success');
            } else {
                addTestResult('‚ùå Vibraci√≥n no disponible en este dispositivo', 'error');
            }
        }
        
        function testOrientation() {
            if (screen.orientation) {
                addTestResult(`üîÑ Orientaci√≥n actual: ${screen.orientation.type}`, 'info');
            } else {
                addTestResult('‚ÑπÔ∏è API de orientaci√≥n no disponible', 'warning');
            }
        }
        
        function testTouch() {
            if ('ontouchstart' in window) {
                addTestResult('üëÜ Soporte t√°ctil detectado y funcionando', 'success');
            } else {
                addTestResult('üñ±Ô∏è Dispositivo no t√°ctil - usando mouse/trackpad', 'info');
            }
        }
        
        function testServerDetection() {
            fetch('/api/device-confirm?' + new URLSearchParams({
                width: window.innerWidth,
                height: window.innerHeight,
                touch: 'ontouchstart' in window,
                orientation: window.innerWidth > window.innerHeight ? 'landscape' : 'portrait'
            }))
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    addTestResult(`üåê Servidor detect√≥: ${data.device.type}`, 'success');
                    console.log('Server detection result:', data);
                } else {
                    addTestResult('‚ùå Error al comunicar con el servidor', 'error');
                }
            })
            .catch(error => {
                addTestResult('‚ùå Error de conexi√≥n con el servidor', 'error');
                console.error('Server detection error:', error);
            });
        }
        
        function refreshDetection() {
            if (window.deviceDetector) {
                deviceDetector.refresh();
                updateDeviceInfo();
                addTestResult('üîÑ Detecci√≥n actualizada correctamente', 'success');
            }
        }
        
        function addTestResult(message, type = 'info') {
            const results = document.getElementById('testResults');
            const result = document.createElement('div');
            result.className = 'test-result';
            result.innerHTML = `<strong>[${new Date().toLocaleTimeString()}]</strong> ${message}`;
            
            switch(type) {
                case 'success': result.style.borderLeftColor = '#4CAF50'; break;
                case 'error': result.style.borderLeftColor = '#f44336'; break;
                case 'warning': result.style.borderLeftColor = '#FF9800'; break;
                default: result.style.borderLeftColor = '#2196F3';
            }
            
            results.appendChild(result);
            results.scrollTop = results.scrollHeight;
        }
        
        // Actualizar informaci√≥n cada segundo
        setInterval(updateDeviceInfo, 1000);
        
        // Actualizar en cambios de orientaci√≥n
        window.addEventListener('orientationchange', () => {
            setTimeout(updateDeviceInfo, 500);
        });
        
        window.addEventListener('resize', updateDeviceInfo);
        
        // Inicializar
        updateDeviceInfo();
        addTestResult('üöÄ Sistema de detecci√≥n de dispositivos inicializado', 'success');
        
        console.log('üì± Device Test Page loaded successfully');
    </script>
</body>
</html> 