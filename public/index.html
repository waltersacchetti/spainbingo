<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpainBingo - Jugar Bingo Online</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="auth.js"></script>
    <script src="security.js"></script>
    <script>
        // Redirigir autom√°ticamente a la p√°gina de bienvenida si es la primera visita
        document.addEventListener('DOMContentLoaded', function() {
            const hasVisitedWelcome = localStorage.getItem('spainbingo_welcome_visited');
            
            // Verificar edad antes de continuar
            if (!securityManager.verifyAge()) {
                return;
            }
            
            // Verificar auto-exclusi√≥n
            if (securityManager.responsibleGaming.selfExclusion.checkExclusion()) {
                alert('Usted tiene una auto-exclusi√≥n activa. No puede acceder al juego.');
                window.location.href = 'welcome.html';
                return;
            }
            
            // Si no ha visitado la p√°gina de bienvenida, redirigir
            if (!hasVisitedWelcome) {
                window.location.href = 'welcome.html';
            }
        });
    </script>
</head>
<body>
    <div class="app-container">
        <!-- Header Profesional -->
        <header class="main-header">
            <div class="header-content">
                <div class="logo-section">
                    <div class="logo">
                        <i class="fas fa-dice"></i>
                        <span>SpainBingo</span>
                    </div>
                    <div class="tagline">El Rey del Bingo Online</div>
                </div>
                
                <div class="user-section">
                    <div class="user-info">
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-details">
                            <div class="username">Jugador</div>
                            <div class="user-level">Nivel 1</div>
                        </div>
                        <button class="btn-logout" onclick="logout()" title="Cerrar sesi√≥n">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                    
                    <div class="balance-section">
                        <div class="balance">
                            <i class="fas fa-coins"></i>
                            <span id="userBalance">‚Ç¨50.00</span>
                        </div>
                        <button class="btn-deposit">
                            <i class="fas fa-plus"></i>
                            Depositar
                        </button>
                    </div>
                </div>
                
                <!-- Bot√≥n discreto para resetear experiencia (solo para desarrollo) -->
                <button class="btn-reset-welcome" onclick="resetWelcomeExperience()" title="Resetear experiencia de bienvenida">
                    <i class="fas fa-redo"></i>
                </button>
            </div>
        </header>

        <!-- Barra de Navegaci√≥n -->
        <nav class="main-nav">
            <div class="nav-content">
                <div class="nav-tabs">
                    <button class="nav-tab active" data-tab="game">
                        <i class="fas fa-gamepad"></i>
                        Jugar
                    </button>
                    <button class="nav-tab" data-tab="cards">
                        <i class="fas fa-ticket-alt"></i>
                        Mis Cartones
                    </button>
                    <button class="nav-tab" data-tab="shop">
                        <i class="fas fa-shopping-cart"></i>
                        Comprar Cartones
                    </button>
                    <button class="nav-tab" data-tab="history">
                        <i class="fas fa-history"></i>
                        Historial
                    </button>
                </div>
                
                <div class="game-status">
                    <div class="status-item">
                        <i class="fas fa-users"></i>
                        <span id="activePlayers">1,247</span> jugadores
                    </div>
                    <div class="status-item">
                        <i class="fas fa-trophy"></i>
                        <span id="currentPrize">‚Ç¨2,500</span> premio
                    </div>
                </div>
            </div>
        </nav>

        <!-- Contenido Principal -->
        <main class="main-content">
            <!-- Pesta√±a de Juego -->
            <div class="tab-content active" id="game-tab">
                <div class="game-layout">
                    <!-- Panel Izquierdo - N√∫meros Llamados -->
                    <div class="left-panel">
                        <div class="panel-header">
                            <h3><i class="fas fa-bullhorn"></i> N√∫meros Llamados</h3>
                            <div class="caller-controls">
                                <button class="btn-call">
                                    <i class="fas fa-dice"></i>
                                    Llamar
                                </button>
                                <button class="btn-auto">
                                    <i class="fas fa-play"></i>
                                    Auto
                                </button>
                                <button class="btn-view-numbers">
                                    <i class="fas fa-eye"></i>
                                    Ver
                                </button>
                            </div>
                        </div>
                        
                        <div class="numbers-grid">
                            <div id="calledNumbers" class="numbers-container">
                                <!-- Los n√∫meros se generar√°n din√°micamente -->
                            </div>
                        </div>
                        
                        <div class="last-number-section">
                            <div class="last-number-label">√öltimo N√∫mero</div>
                            <div id="lastNumber" class="last-number-display">-</div>
                        </div>
                    </div>

                    <!-- Panel Central - Cartones -->
                    <div class="center-panel">
                        <div class="panel-header">
                            <h3><i class="fas fa-ticket-alt"></i> Mis Cartones</h3>
                            <div class="card-controls">
                                <button class="btn-new-game">
                                    <i class="fas fa-plus"></i>
                                    Nuevo Juego
                                </button>
                            </div>
                        </div>
                        
                        <div class="cards-container">
                            <div id="bingoCards" class="cards-grid">
                                <!-- Los cartones se generar√°n din√°micamente -->
                            </div>
                        </div>
                    </div>

                    <!-- Panel Derecho - Estad√≠sticas y Chat -->
                    <div class="right-panel">
                        <div class="stats-section">
                            <div class="panel-header">
                                <h3><i class="fas fa-chart-bar"></i> Estad√≠sticas</h3>
                            </div>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-dice"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-value" id="numbersCalled">0</div>
                                        <div class="stat-label">Llamados</div>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-value" id="numbersMarked">0</div>
                                        <div class="stat-label">Marcados</div>
                                    </div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-trophy"></i>
                                    </div>
                                    <div class="stat-info">
                                        <div class="stat-value" id="linesCompleted">0</div>
                                        <div class="stat-label">L√≠neas</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chat-section">
                            <div class="panel-header">
                                <h3><i class="fas fa-comments"></i> Chat en Vivo</h3>
                            </div>
                            <div class="chat-container">
                                <div class="chat-messages" id="chatMessages">
                                    <div class="chat-message system">
                                        <span class="message-time">15:30</span>
                                        <span class="message-text">¬°Bienvenido al BingoPro!</span>
                                    </div>
                                    <div class="chat-message">
                                        <span class="message-user">Mar√≠a:</span>
                                        <span class="message-text">¬°Buena suerte a todos!</span>
                                    </div>
                                    <div class="chat-message">
                                        <span class="message-user">Carlos:</span>
                                        <span class="message-text">Casi tengo l√≠nea üòÑ</span>
                                    </div>
                                </div>
                                <div class="chat-input">
                                    <input type="text" placeholder="Escribe un mensaje..." id="chatInput">
                                    <button class="btn-send">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pesta√±a de Mis Cartones -->
            <div class="tab-content" id="cards-tab">
                <div class="my-cards-section">
                    <div class="section-header">
                        <h2>Mis Cartones</h2>
                        <div class="cards-summary">
                            <div class="summary-item">
                                <span class="summary-value" id="totalCards">3</span>
                                <span class="summary-label">Cartones</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-value" id="activeCards">2</span>
                                <span class="summary-label">Activos</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="cards-list" id="myCardsList">
                        <!-- Los cartones se mostrar√°n aqu√≠ -->
                    </div>
                </div>
            </div>

            <!-- Pesta√±a de Comprar Cartones -->
            <div class="tab-content" id="shop-tab">
                <div class="shop-section">
                    <div class="section-header">
                        <h2>Comprar Cartones</h2>
                        <p>Selecciona el paquete que prefieras</p>
                    </div>
                    
                    <div class="packages-grid">
                        <div class="package-card">
                            <div class="package-header">
                                <h3>Paquete B√°sico</h3>
                                <div class="package-price">‚Ç¨2.50</div>
                            </div>
                            <div class="package-features">
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>1 Cart√≥n</span>
                                </div>
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>V√°lido 24h</span>
                                </div>
                            </div>
                            <button class="btn-buy" data-package="basic">
                                Comprar
                            </button>
                        </div>

                        <div class="package-card popular">
                            <div class="popular-badge">M√°s Popular</div>
                            <div class="package-header">
                                <h3>Paquete Premium</h3>
                                <div class="package-price">‚Ç¨8.00</div>
                            </div>
                            <div class="package-features">
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>5 Cartones</span>
                                </div>
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>V√°lido 7 d√≠as</span>
                                </div>
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>+20% premios</span>
                                </div>
                            </div>
                            <button class="btn-buy" data-package="premium">
                                Comprar
                            </button>
                        </div>

                        <div class="package-card">
                            <div class="package-header">
                                <h3>Paquete VIP</h3>
                                <div class="package-price">‚Ç¨15.00</div>
                            </div>
                            <div class="package-features">
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>12 Cartones</span>
                                </div>
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>V√°lido 30 d√≠as</span>
                                </div>
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>+50% premios</span>
                                </div>
                                <div class="feature">
                                    <i class="fas fa-check"></i>
                                    <span>Chat VIP</span>
                                </div>
                            </div>
                            <button class="btn-buy" data-package="vip">
                                Comprar
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pesta√±a de Historial -->
            <div class="tab-content" id="history-tab">
                <div class="history-section">
                    <div class="section-header">
                        <h2>Historial de Juegos</h2>
                    </div>
                    
                    <div class="history-filters">
                        <button class="filter-btn active" data-filter="all">Todos</button>
                        <button class="filter-btn" data-filter="wins">Victorias</button>
                        <button class="filter-btn" data-filter="purchases">Compras</button>
                    </div>
                    
                    <div class="history-list" id="historyList">
                        <!-- El historial se mostrar√° aqu√≠ -->
                    </div>
                </div>
            </div>
        </main>

        <!-- Modales -->
        <div id="depositModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Depositar Fondos</h3>
                    <button class="modal-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="payment-methods">
                        <div class="payment-method active" data-method="card">
                            <i class="fas fa-credit-card"></i>
                            <span>Tarjeta de Cr√©dito</span>
                        </div>
                        <div class="payment-method" data-method="paypal">
                            <i class="fab fa-paypal"></i>
                            <span>PayPal</span>
                        </div>
                    </div>
                    
                    <div class="amount-selector">
                        <label>Monto a depositar:</label>
                        <div class="amount-options">
                            <button class="amount-btn" data-amount="10">‚Ç¨10</button>
                            <button class="amount-btn" data-amount="25">‚Ç¨25</button>
                            <button class="amount-btn" data-amount="50">‚Ç¨50</button>
                            <button class="amount-btn" data-amount="100">‚Ç¨100</button>
                        </div>
                        <div class="custom-amount">
                            <input type="number" placeholder="Otro monto" id="customAmount" min="5" max="1000">
                        </div>
                    </div>
                    
                    <div class="payment-form">
                        <div class="form-group">
                            <label>N√∫mero de tarjeta</label>
                            <input type="text" placeholder="1234 5678 9012 3456" id="cardNumber">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Fecha de expiraci√≥n</label>
                                <input type="text" placeholder="MM/AA" id="cardExpiry">
                            </div>
                            <div class="form-group">
                                <label>CVV</label>
                                <input type="text" placeholder="123" id="cardCvv">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel">Cancelar</button>
                    <button class="btn-confirm">Depositar ‚Ç¨<span id="depositAmount">25</span></button>
                </div>
            </div>
        </div>

        <div id="winModal" class="modal">
            <div class="modal-content win-modal">
                <div class="modal-header">
                    <h3>¬°Felicidades!</h3>
                </div>
                <div class="modal-body">
                    <div class="win-animation">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <div class="win-details" id="winDetails">
                        <!-- Los detalles de la victoria se mostrar√°n aqu√≠ -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-confirm">Continuar</button>
                </div>
            </div>
        </div>

        <!-- Modal de N√∫meros Llamados -->
        <div id="calledNumbersModal" class="modal">
            <div class="modal-content called-numbers-modal">
                <div class="modal-header">
                    <h3><i class="fas fa-bullhorn"></i> N√∫meros Llamados</h3>
                    <button class="modal-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="called-numbers-summary">
                        <div class="summary-stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Llamados:</span>
                                <span class="stat-value" id="modalTotalCalled">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">√öltimo N√∫mero:</span>
                                <span class="stat-value" id="modalLastNumber">-</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">N√∫meros Restantes:</span>
                                <span class="stat-value" id="modalRemaining">90</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="called-numbers-grid">
                        <div class="numbers-section">
                            <h4>N√∫meros del 1-30</h4>
                            <div class="numbers-row" id="numbers1-30"></div>
                        </div>
                        <div class="numbers-section">
                            <h4>N√∫meros del 31-60</h4>
                            <div class="numbers-row" id="numbers31-60"></div>
                        </div>
                        <div class="numbers-section">
                            <h4>N√∫meros del 61-90</h4>
                            <div class="numbers-row" id="numbers61-90"></div>
                        </div>
                    </div>
                    
                    <div class="called-numbers-list">
                        <h4>Historial de Llamadas</h4>
                        <div class="called-list" id="calledNumbersList">
                            <!-- Los n√∫meros llamados se mostrar√°n aqu√≠ en orden cronol√≥gico -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-confirm">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html> 